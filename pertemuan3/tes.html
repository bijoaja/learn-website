<html lang="en"><head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css">
    

    <!-- Font Awesome -->
    <link rel="stylesheet" href="../assets/fontawesome/css/all.min.css">

    <title>The Movie Database</title>
    <style>
        h1 {
            font-size: 2em;
        }
    </style>
</head>

<body>
    <div class="container my-2">
        <div class="float-end">
            <a href="form.html" class="btn btn-primary"><i class="fa-solid fa-circle-plus me-2"></i>Create</a>
        </div>
        <h1>Popular Movies</h1>
        <div class="row mt-4">
            <div class="col-lg-4 col-xxl-3 mb-3">
                <form id="bikininSearch">
                    <input type="hidden" name="sort" value="title">
                    <input type="hidden" name="order" value="ASC">
                    <input type="hidden" name="skip" value="0">
                    <input type="hidden" name="take" value="12">
                    <input type="hidden" name="search" value="{&quot;title&quot;:&quot;&quot;,&quot;rating&quot;:&quot;&quot;}">
                    <div class="card mb-3">
                        <h5 class="card-header"><i class="fa-solid fa-arrow-down-a-z me-2"></i>Sorting</h5>
                        <div class="card-body">
                            <div class="form-floating">
                                <select class="form-select" id="sort" aria-label="Sort Results By">
                                    <option value="title|ASC" selected="selected">Title Ascending</option>
                                    <option value="title|DESC">Title Descending</option>
                                    <option value="rating|ASC">Rating Ascending</option>
                                    <option value="rating|DESC">Rating Descending</option>
                                </select>
                                <label for="sort">Sort Results By</label>
                            </div>
                        </div>
                    </div>
                    <div class="card mb-3">
                        <h5 class="card-header"><i class="fa-solid fa-filter me-2"></i>Filters</h5>
                        <div class="card-body">
                            <div class="form-floating mb-3">
                                <input type="text" class="form-control" id="title" placeholder="Search by Movie Title">
                                <label for="title">Search by Movie Title</label>
                            </div>
                            <div class="form-floating">
                                <select class="form-select" id="rating" aria-label="Search by Movie Rating">
                                    <option value="" selected="selected">-</option>
                                    <option>G</option>
                                    <option>PG</option>
                                    <option>PG-13</option>
                                    <option>R</option>
                                    <option>NC-17</option>
                                </select>
                                <label for="rating">Search by Movie Rating</label>
                            </div>
                        </div>
                    </div>
                    <div class="d-grid">
                        <button type="sumbit" class="btn btn-primary"><i class="fa-solid fa-magnifying-glass me-2"></i>Search</button>
                    </div>
                </form>
            </div>
            <div class="col-lg-8 col-xxl-9">
                <div class="row g-3" id="bikininData"><div class="col-sm-6 col-lg-4 col-xxl-3"><div class="card"><a href="detail.html?film_id=1"><img class="card-img-top" src="http://pbw.ilkom.unej.ac.id/dev/project/assets/images/1.jpg" alt="No Image Available"></a><div class="card-body"><h5 class="card-title">ACADEMY DINOSAUR</h5><div class="float-end"><a class="me-1" href="form.html?film_id=1" title="Update"><i class="fa-solid fa-pen-to-square"></i></a><a class="text-danger" href="#" title="Delete" onclick="event.preventDefault(); remove(1);"><i class="fa-solid fa-trash-can"></i></a></div><div class="card-text">Rating: PG</div></div></div></div><div class="col-sm-6 col-lg-4 col-xxl-3"><div class="card"><a href="detail.html?film_id=2"><img class="card-img-top" src="http://pbw.ilkom.unej.ac.id/dev/project/assets/images/2.jpg" alt="No Image Available"></a><div class="card-body"><h5 class="card-title">ACE GOLDFINGER</h5><div class="float-end"><a class="me-1" href="form.html?film_id=2" title="Update"><i class="fa-solid fa-pen-to-square"></i></a><a class="text-danger" href="#" title="Delete" onclick="event.preventDefault(); remove(2);"><i class="fa-solid fa-trash-can"></i></a></div><div class="card-text">Rating: G</div></div></div></div><div class="col-sm-6 col-lg-4 col-xxl-3"><div class="card"><a href="detail.html?film_id=3"><img class="card-img-top" src="http://pbw.ilkom.unej.ac.id/dev/project/assets/images/3.jpg" alt="No Image Available"></a><div class="card-body"><h5 class="card-title">ADAPTATION HOLES</h5><div class="float-end"><a class="me-1" href="form.html?film_id=3" title="Update"><i class="fa-solid fa-pen-to-square"></i></a><a class="text-danger" href="#" title="Delete" onclick="event.preventDefault(); remove(3);"><i class="fa-solid fa-trash-can"></i></a></div><div class="card-text">Rating: NC-17</div></div></div></div><div class="col-sm-6 col-lg-4 col-xxl-3"><div class="card"><a href="detail.html?film_id=4"><img class="card-img-top" src="http://pbw.ilkom.unej.ac.id/dev/project/assets/no_image.jpg" alt="No Image Available"></a><div class="card-body"><h5 class="card-title">AFFAIR PREJUDICE</h5><div class="float-end"><a class="me-1" href="form.html?film_id=4" title="Update"><i class="fa-solid fa-pen-to-square"></i></a><a class="text-danger" href="#" title="Delete" onclick="event.preventDefault(); remove(4);"><i class="fa-solid fa-trash-can"></i></a></div><div class="card-text">Rating: G</div></div></div></div><div class="col-sm-6 col-lg-4 col-xxl-3"><div class="card"><a href="detail.html?film_id=5"><img class="card-img-top" src="http://pbw.ilkom.unej.ac.id/dev/project/assets/no_image.jpg" alt="No Image Available"></a><div class="card-body"><h5 class="card-title">AFRICAN EGG</h5><div class="float-end"><a class="me-1" href="form.html?film_id=5" title="Update"><i class="fa-solid fa-pen-to-square"></i></a><a class="text-danger" href="#" title="Delete" onclick="event.preventDefault(); remove(5);"><i class="fa-solid fa-trash-can"></i></a></div><div class="card-text">Rating: G</div></div></div></div><div class="col-sm-6 col-lg-4 col-xxl-3"><div class="card"><a href="detail.html?film_id=6"><img class="card-img-top" src="http://pbw.ilkom.unej.ac.id/dev/project/assets/no_image.jpg" alt="No Image Available"></a><div class="card-body"><h5 class="card-title">AGENT TRUMAN</h5><div class="float-end"><a class="me-1" href="form.html?film_id=6" title="Update"><i class="fa-solid fa-pen-to-square"></i></a><a class="text-danger" href="#" title="Delete" onclick="event.preventDefault(); remove(6);"><i class="fa-solid fa-trash-can"></i></a></div><div class="card-text">Rating: PG</div></div></div></div><div class="col-sm-6 col-lg-4 col-xxl-3"><div class="card"><a href="detail.html?film_id=7"><img class="card-img-top" src="http://pbw.ilkom.unej.ac.id/dev/project/assets/no_image.jpg" alt="No Image Available"></a><div class="card-body"><h5 class="card-title">AIRPLANE SIERRA</h5><div class="float-end"><a class="me-1" href="form.html?film_id=7" title="Update"><i class="fa-solid fa-pen-to-square"></i></a><a class="text-danger" href="#" title="Delete" onclick="event.preventDefault(); remove(7);"><i class="fa-solid fa-trash-can"></i></a></div><div class="card-text">Rating: PG-13</div></div></div></div><div class="col-sm-6 col-lg-4 col-xxl-3"><div class="card"><a href="detail.html?film_id=8"><img class="card-img-top" src="http://pbw.ilkom.unej.ac.id/dev/project/assets/no_image.jpg" alt="No Image Available"></a><div class="card-body"><h5 class="card-title">AIRPORT POLLOCK</h5><div class="float-end"><a class="me-1" href="form.html?film_id=8" title="Update"><i class="fa-solid fa-pen-to-square"></i></a><a class="text-danger" href="#" title="Delete" onclick="event.preventDefault(); remove(8);"><i class="fa-solid fa-trash-can"></i></a></div><div class="card-text">Rating: R</div></div></div></div><div class="col-sm-6 col-lg-4 col-xxl-3"><div class="card"><a href="detail.html?film_id=9"><img class="card-img-top" src="http://pbw.ilkom.unej.ac.id/dev/project/assets/no_image.jpg" alt="No Image Available"></a><div class="card-body"><h5 class="card-title">ALABAMA DEVIL</h5><div class="float-end"><a class="me-1" href="form.html?film_id=9" title="Update"><i class="fa-solid fa-pen-to-square"></i></a><a class="text-danger" href="#" title="Delete" onclick="event.preventDefault(); remove(9);"><i class="fa-solid fa-trash-can"></i></a></div><div class="card-text">Rating: PG-13</div></div></div></div><div class="col-sm-6 col-lg-4 col-xxl-3"><div class="card"><a href="detail.html?film_id=10"><img class="card-img-top" src="http://pbw.ilkom.unej.ac.id/dev/project/assets/no_image.jpg" alt="No Image Available"></a><div class="card-body"><h5 class="card-title">ALADDIN CALENDAR</h5><div class="float-end"><a class="me-1" href="form.html?film_id=10" title="Update"><i class="fa-solid fa-pen-to-square"></i></a><a class="text-danger" href="#" title="Delete" onclick="event.preventDefault(); remove(10);"><i class="fa-solid fa-trash-can"></i></a></div><div class="card-text">Rating: NC-17</div></div></div></div><div class="col-sm-6 col-lg-4 col-xxl-3"><div class="card"><a href="detail.html?film_id=11"><img class="card-img-top" src="http://pbw.ilkom.unej.ac.id/dev/project/assets/no_image.jpg" alt="No Image Available"></a><div class="card-body"><h5 class="card-title">ALAMO VIDEOTAPE</h5><div class="float-end"><a class="me-1" href="form.html?film_id=11" title="Update"><i class="fa-solid fa-pen-to-square"></i></a><a class="text-danger" href="#" title="Delete" onclick="event.preventDefault(); remove(11);"><i class="fa-solid fa-trash-can"></i></a></div><div class="card-text">Rating: G</div></div></div></div><div class="col-sm-6 col-lg-4 col-xxl-3"><div class="card"><a href="detail.html?film_id=12"><img class="card-img-top" src="http://pbw.ilkom.unej.ac.id/dev/project/assets/no_image.jpg" alt="No Image Available"></a><div class="card-body"><h5 class="card-title">ALASKA PHANTOM</h5><div class="float-end"><a class="me-1" href="form.html?film_id=12" title="Update"><i class="fa-solid fa-pen-to-square"></i></a><a class="text-danger" href="#" title="Delete" onclick="event.preventDefault(); remove(12);"><i class="fa-solid fa-trash-can"></i></a></div><div class="card-text">Rating: PG</div></div></div></div><div class="d-grid"><button class="btn btn-primary" id="bikininMore" onclick="loadMore(12)"><i class="fa-solid fa-circle-chevron-down me-2"></i>Load More</button></div></div>
            </div>
        </div>
    </div>

    <!-- Bootstrap Bundle with Popper -->
    <script src="../assets/bootstrap/js/bootstrap.bundle.min.js"></script>

    <!-- jQuery -->
    <script src="../assets/jquery-3.6.0.min.js"></script>

    <!-- Page JS -->
    <script>
        function refresh(skip = 0) {
            var temp = $("#bikininSearch #sort").val().split('|');
            $("#bikininSearch input[name=sort]").val(temp[0]);
            $("#bikininSearch input[name=order]").val(temp[1]);
            $("#bikininSearch input[name=skip]").val(skip);
            $("#bikininSearch input[name=search]").val(JSON.stringify({
                "title" : $("#bikininSearch #title").val().trim(),
                "rating": $("#bikininSearch #rating").val(),
            }));
            $.get("film.php?action=read", $("#bikininSearch").serialize(), function(response) {
                $("#bikininLoading").remove();
                if (response.total > 0) {
                    $.each(response.data, function(key, value) {
                        $("#bikininData").append("<div class='col-sm-6 col-lg-4 col-xxl-3'><div class='card'>" +
                            "<a href='detail.html?film_id=" + value.film_id + "'><img class='card-img-top' src='" + value.thumbnail + "' alt='No Image Available' /></a>" +
                            "<div class='card-body'>" +
                                "<h5 class='card-title'>" + value.title + "</h5>" +
                                "<div class='float-end'>" +
                                    "<a class='me-1' href='form.html?film_id=" + value.film_id + "' title='Update'><i class='fa-solid fa-pen-to-square'></i></a>" +
                                    "<a class='text-danger' href='#' title='Delete' onclick='event.preventDefault(); remove(" + value.film_id + ");'><i class='fa-solid fa-trash-can'></i></a>" +
                                "</div>" +
                                "<div class='card-text'>Rating: " + value.rating + "</div>" +
                            "</div>" +
                        "</div></div>");
                    });
                } else {
                    $("#bikininData").html("<div class='col-12'><div class='alert alert-warning' role='alert'>No data found.</div></div>");
                }
                if (skip < response.total - parseInt($("#bikininSearch input[name=take]").val())) {
                    $("#bikininData").append("<div class='d-grid'><button class='btn btn-primary' id='bikininMore' onclick='loadMore(" + (skip + parseInt($("#bikininSearch input[name=take]").val())) + ")'><i class='fa-solid fa-circle-chevron-down me-2'></i>Load More</button></div>");
                }
            }).fail(function(xhr, status, error) {
                $(".container").html("<div class='alert alert-danger' role='alert'><strong>Error " + xhr.status + "!</strong> " + xhr.responseText + "</div>");
            });
        }

        function loadMore(skip) {
            $("#bikininMore").remove();
            $("#bikininData").append("<div id='bikininLoading'><span class='spinner-grow spinner-grow-sm me-2' role='status' aria-hidden='true'></span>Loading...</div>");
            refresh(parseInt($("#bikininSearch input[name=skip]").val()) + parseInt($("#bikininSearch input[name=take]").val()));
        }

        function remove(film_id) {
            if (confirm("Are you sure want to delete this data?")) {
                $.post("film.php", { "action": "delete", "film_id": film_id }, function (response) {
                    $("#bikininData").html("<div id='bikininLoading'><span class='spinner-grow spinner-grow-sm me-2' role='status' aria-hidden='true'></span>Loading...</div>");
                    refresh();
                }).fail(function (xhr, status, error) {
                    $("#bikininData").prepend("<div class='alert alert-danger alert-dismissible fade show' role='alert'><strong>Error " + xhr.status + "!</strong> " + xhr.responseText + "<button type='button' class='btn-close' data-bs-dismiss='alert' aria-label='Close'></button></div>");
                });
            }
        }

        $(document).ready(function() {
            $("#bikininSearch").submit(function (event) {
                event.preventDefault();
                $("#bikininData").html("<div id='bikininLoading'><span class='spinner-grow spinner-grow-sm me-2' role='status' aria-hidden='true'></span>Loading...</div>");
                refresh();
            });
            refresh();
        });
    </script>



</body></html>